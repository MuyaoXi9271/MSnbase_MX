<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Representation of chromatographic MS data — Chromatogram • MSnbase</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Representation of chromatographic MS data — Chromatogram" />
<meta property="og:description" content="The Chromatogram class is designed to store
chromatographic MS data, i.e. pairs of retention time and intensity
values. Instances of the class can be created with the
Chromatogram constructor function but in most cases the dedicated
methods for OnDiskMSnExp and
MSnExp objects extracting chromatograms should be
used instead (i.e. the chromatogram() method)." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MSnbase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.19.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a>
    </li>
    <li>
      <a href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a>
    </li>
    <li>
      <a href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a>
    </li>
    <li>
      <a href="../articles/v04-benchmarking.html">MSnbase benchmarking</a>
    </li>
    <li>
      <a href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lgatto/MSnbase/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Representation of chromatographic MS data</h1>
    <small class="dont-index">Source: <a href='https://github.com/lgatto/MSnbase/blob/master/R/functions-Chromatogram.R'><code>R/functions-Chromatogram.R</code></a>, <a href='https://github.com/lgatto/MSnbase/blob/master/R/methods-Chromatogram.R'><code>R/methods-Chromatogram.R</code></a></small>
    <div class="hidden name"><code>Chromatogram-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>Chromatogram</code> class is designed to store
chromatographic MS data, i.e. pairs of retention time and intensity
values. Instances of the class can be created with the
<code>Chromatogram</code> constructor function but in most cases the dedicated
methods for <a href='OnDiskMSnExp-class.html'>OnDiskMSnExp</a> and
<a href='MSnExp-class.html'>MSnExp</a> objects extracting chromatograms should be
used instead (i.e. the <code><a href='chromatogram-MSnExp-method.html'>chromatogram()</a></code> method).</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>Chromatogram</span><span class='op'>(</span>
  rtime <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='op'>)</span>,
  intensity <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='op'>)</span>,
  mz <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA_real_</span>, <span class='cn'>NA_real_</span><span class='op'>)</span>,
  filterMz <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA_real_</span>, <span class='cn'>NA_real_</span><span class='op'>)</span>,
  precursorMz <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA_real_</span>, <span class='cn'>NA_real_</span><span class='op'>)</span>,
  productMz <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA_real_</span>, <span class='cn'>NA_real_</span><span class='op'>)</span>,
  fromFile <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>integer</a></span><span class='op'>(</span><span class='op'>)</span>,
  aggregationFun <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>,
  msLevel <span class='op'>=</span> <span class='fl'>1L</span>
<span class='op'>)</span>

<span class='fu'>aggregationFun</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'>show</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='Spectrum-class.html'>rtime</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='Spectrum-class.html'>mz</a></span><span class='op'>(</span><span class='va'>object</span>, filter <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='Spectrum2-class.html'>precursorMz</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='Spectrum-class.html'>fromFile</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='MSnExp-class.html'>filterRt</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>rt</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='clean-methods.html'>clean</a></span><span class='op'>(</span><span class='va'>object</span>, all <span class='op'>=</span> <span class='cn'>FALSE</span>, na.rm <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram,ANY</span>
<span class='fu'><a href='plot-methods.html'>plot</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  col <span class='op'>=</span> <span class='st'>"#00000060"</span>,
  lty <span class='op'>=</span> <span class='fl'>1</span>,
  type <span class='op'>=</span> <span class='st'>"l"</span>,
  xlab <span class='op'>=</span> <span class='st'>"retention time"</span>,
  ylab <span class='op'>=</span> <span class='st'>"intensity"</span>,
  main <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='Spectrum-class.html'>msLevel</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'>isEmpty</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'>productMz</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='bin-methods.html'>bin</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  binSize <span class='op'>=</span> <span class='fl'>0.5</span>,
  breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>floor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'><a href='Spectrum-class.html'>rtime</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>ceiling</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='Spectrum-class.html'>rtime</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='va'>binSize</span><span class='op'>)</span>,
  fun <span class='op'>=</span> <span class='va'>max</span>
<span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'><a href='normalise-methods.html'>normalize</a></span><span class='op'>(</span><span class='va'>object</span>, method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"max"</span>, <span class='st'>"sum"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram</span>
<span class='fu'>filterIntensity</span><span class='op'>(</span><span class='va'>object</span>, intensity <span class='op'>=</span> <span class='fl'>0</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram,Chromatogram</span>
<span class='fu'>alignRt</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"closest"</span>, <span class='st'>"approx"</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for Chromatogram,Chromatogram</span>
<span class='fu'>compareChromatograms</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  ALIGNFUN <span class='op'>=</span> <span class='va'>alignRt</span>,
  ALIGNFUNARGS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  FUN <span class='op'>=</span> <span class='va'>cor</span>,
  FUNARGS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>use <span class='op'>=</span> <span class='st'>"pairwise.complete.obs"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>rtime</th>
      <td><p>for <code>Chromatogram</code>: <code>numeric</code> with the retention times (length
has to be equal to the length of <code>intensity</code>).</p></td>
    </tr>
    <tr>
      <th>intensity</th>
      <td><p>for <code>Chromatogram</code>: <code>numeric</code> with the intensity values
(length has to be equal to the length of <code>rtime</code>). For <code>filterIntensity</code>:
<code>numeric(1)</code> or <code>function</code> to use to filter intensities. See description
for details.</p></td>
    </tr>
    <tr>
      <th>mz</th>
      <td><p>for <code>Chromatogram</code>: <code>numeric(2)</code> representing the mz value range
(min, max) on which the chromatogram was created. This is supposed to
contain the <em>real</em> range of mz values in contrast to <code>filterMz</code>.
If not applicable use <code>mzrange = c(0, 0)</code>.</p></td>
    </tr>
    <tr>
      <th>filterMz</th>
      <td><p>for <code>Chromatogram</code>: <code>numeric(2)</code> representing the mz value
range (min, max) that was used to filter the original object on m/z
dimension. If not applicable use <code>filterMz = c(0, 0)</code>.</p></td>
    </tr>
    <tr>
      <th>precursorMz</th>
      <td><p>for <code>Chromatogram</code>: <code>numeric(2)</code> for SRM/MRM transitions.
Represents the mz of the precursor ion. See details for more information.</p></td>
    </tr>
    <tr>
      <th>productMz</th>
      <td><p>for <code>Chromatogram</code>: <code>numeric(2)</code> for SRM/MRM transitions.
Represents the mz of the product. See details for more information.</p></td>
    </tr>
    <tr>
      <th>fromFile</th>
      <td><p>for <code>Chromatogram</code>: <code>integer(1)</code> the index of the file within
the <code>OnDiskMSnExp</code> or <code>MSnExp</code> from which the chromatogram was extracted.</p></td>
    </tr>
    <tr>
      <th>aggregationFun</th>
      <td><p>for <code>Chromatogram</code>: <code>character</code> string specifying
the function that was used to aggregate intensity values for the same
retention time across the mz range. Supported are <code>"sum"</code> (total ion
chromatogram), <code>"max"</code> (base peak chromatogram), <code>"min"</code> and <code>"mean"</code>.</p></td>
    </tr>
    <tr>
      <th>msLevel</th>
      <td><p>for <code>Chromatogram</code>: <code>integer(1)</code> with the MS level from
which the chromatogram was extracted.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p><code>Chromatogram</code> object.</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>for <code>mz</code>: <code>logical(1)</code> defining whether the m/z range to filter
the originating object (e.g. <code>MSnExp</code> object) should be returned or the
m/z range of the actual data. Defaults to <code>filter = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p><code>Chromatogram</code> object.</p></td>
    </tr>
    <tr>
      <th>rt</th>
      <td><p>for <code>filterRt</code>: <code>numeric(2)</code> defining the lower and upper retention
time to which the <code>Chromatogram</code> should be subsetted.</p></td>
    </tr>
    <tr>
      <th>all</th>
      <td><p>for <code>clean</code>: <code>logical(1)</code> whether all 0 intensities should be
removed. Defaults to <code>all = FALSE</code>. See <code><a href='clean-methods.html'>clean()</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>for <code>clean</code>: if all <code>NA</code> intensities should be removed before
cleaning the <code>Chromatogram</code>. Defaults to <code>clean = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>for <code>plot</code>: the color to be used for plotting.</p></td>
    </tr>
    <tr>
      <th>lty</th>
      <td><p>for <code>plot</code>: the line type. See help page of <code>plot</code> in
the <code>graphics</code> package for details.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>for <code>plot</code>: the type of plot. See help page of <code>plot</code> in
the <code>graphics</code> package for details.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>for <code>plot</code>: the x-axis label.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>for <code>plot</code>: the y-axis label.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>for <code>plot</code>: the plot title. If not provided the mz range
will be used as plot title.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>for <code>plot</code>: additional arguments to be passed to the
base <code>plot</code> function. For <code>filterIntensity</code>: additional parameters passed
along to the function provided with <code>intensity</code>.
For <code>compareChromatograms</code>: ignored</p></td>
    </tr>
    <tr>
      <th>binSize</th>
      <td><p>for <code>bin</code>: <code>numeric(1)</code> with the size of the bins
(in seconds). Defaults to <code>binSize = 0.5</code>.</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>for <code>bin</code>: <code>numeric</code> defining the bins. Usually not
required as the function calculates the bins automatically based on
<code>binSize</code>.</p></td>
    </tr>
    <tr>
      <th>fun</th>
      <td><p>for <code>bin</code>: function to be used to aggregate the intensity
values falling within each bin. Defaults to <code>fun = max</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p><code>character(1)</code>. For <code>normalise</code>: defining whether each
chromatogram should be normalized to its maximum signal
(<code>method = "max"</code>) or total signal (<code>method = "sum"</code>).
For <code>alignRt</code>: aligning approach that should be used (see description).
Defaults to <code>method = "closest"</code>.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>for <code>alignRt</code>: <code>Chromatogram</code> against which <code>x</code> should be aligned
against.</p></td>
    </tr>
    <tr>
      <th>ALIGNFUN</th>
      <td><p>for <code>compareChromatograms</code>: function to align chromatogram
<code>x</code> against chromatogram <code>y</code>. Defaults to <code>alignRt</code>.</p></td>
    </tr>
    <tr>
      <th>ALIGNFUNARGS</th>
      <td><p><code>list</code> of parameters to be passed to <code>ALIGNFUN</code>.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>for <code>compareChromatograms</code>: function to calculate a similarity
score on the intensity values of the compared and aligned chromatograms.
Defaults to <code>FUN = cor</code>.</p></td>
    </tr>
    <tr>
      <th>FUNARGS</th>
      <td><p>for <code>compareChromatograms</code>: <code>list</code> with additional parameters
for <code>FUN</code>. Defaults to <code>FUNARGS = list(use = "pairwise.complete.obs")</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>mz</code>, <code>filterMz</code>, <code>precursorMz</code> and
<code>productMz</code> are stored as a <code>numeric(2)</code> representing a range
even if the chromatogram was generated for only a single ion (i.e. a
single mz value). Using ranges for <code>mz</code> values allow this class to
be used also for e.g. total ion chromatograms or base peak chromatograms.</p><pre><code>The slots `precursorMz` and `productMz` allow to represent SRM
(single reaction monitoring) and MRM (multiple SRM) chromatograms. As
example, a `Chromatogram` for a SRM transition 273 -&gt; 153 will have
a `@precursorMz = c(273, 273)` and a
`@productMz = c(153, 153)`.
</code></pre>

    <h2 class="hasAnchor" id="object-creation"><a class="anchor" href="#object-creation"></a>Object creation</h2>

    


<p><code>Chromatogram</code> objects can be extracted from an <code>MSnExp</code> or <code>OnDiskMSnExp</code>
object with the <code><a href='chromatogram-MSnExp-method.html'>chromatogram()</a></code> function.</p>
<p>Alternatively, the constructor function <code>Chromatogram</code> can be used, which
takes arguments <code>rtime</code>, <code>intensity</code>, <code>mz</code>, <code>filterMz</code>, <code>precursorMz</code>,
<code>productMz</code>, <code>fromFile</code>, <code>aggregationFun</code> and <code>msLevel</code>.</p>
    <h2 class="hasAnchor" id="data-access-and-coercion"><a class="anchor" href="#data-access-and-coercion"></a>Data access and coercion</h2>

    

<ul>
<li><p><code>aggregationFun</code>: gets the aggregation function used to create the
<code>Chromatogram</code>.</p></li>
<li><p><code>as.data.frame</code>: returns a <code>data.frame</code> with columns <code>"rtime"</code> and
<code>"intensity"</code>.</p></li>
<li><p><code>fromFile</code>: returns an <code>integer(1)</code> with the index of the originating file.</p></li>
<li><p><code>intensity</code>: returns the intensities from the <code>Chromatogram</code>.</p></li>
<li><p><code>isEmpty</code>: returns <code>TRUE</code> if the chromatogram is empty or has only <code>NA</code>
intensities.</p></li>
<li><p><code>length</code>: returns the length (i.e. number of data points) of the
<code>Chromatogram</code>.</p></li>
<li><p><code>msLevel</code>: returns an <code>integer(1)</code> with the MS level of the chromatogram.</p></li>
<li><p><code>mz</code>: get the m/z (range) from the <code>Chromatogram</code>. The function returns
a <code>numeric(2)</code> with the lower and upper boundaries. Parameter <code>filter</code>
allows to specify whether the m/z range used to filter the originating
object should be returned or the m/z range of the actual data.</p></li>
<li><p><code>precursorMz</code>: get the m/z of the precursor ion. The function returns a
<code>numeric(2)</code> with the lower and upper boundary.</p></li>
<li><p><code>productMz</code>: get the m/z of the producto chromatogram/ion. The function
returns a <code>numeric(2)</code> with the lower and upper m/z value.</p></li>
<li><p><code>rtime</code>: returns the retention times from the <code>Chromatogram</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="data-subsetting-and-filtering"><a class="anchor" href="#data-subsetting-and-filtering"></a>Data subsetting and filtering</h2>

    

<ul>
<li><p><code>filterRt</code>: filter/subset the <code>Chromatogram</code> to the specified retention
time range (defined with parameter <code>rt</code>).</p></li>
<li><p><code>filterIntensity</code>: filter a <code>Chromatogram()</code> object removing data
points with intensities below a user provided threshold. If <code>intensity</code>
is a <code>numeric</code> value, the returned chromatogram will only contain data
points with intensities &gt; <code>intensity</code>. In addition it is possible to
provide a function to perform the filtering.
This function is expected to take the input <code>Chromatogram</code> (<code>object</code>) and
to return a logical vector with the same length then there are data points
in <code>object</code> with <code>TRUE</code> for data points that should be kept and <code>FALSE</code>
for data points that should be removed. See examples below.</p></li>
</ul>

    <h2 class="hasAnchor" id="data-processing-and-manipulation"><a class="anchor" href="#data-processing-and-manipulation"></a>Data processing and manipulation</h2>

    

<ul>
<li><p><code>alignRt</code>: Aligns chromatogram <code>x</code> against chromatogram <code>y</code>. The resulting
chromatogram has the same length (number of data points) than <code>y</code> and the
same retention times thus allowing to perform any pair-wise comparisons
between the chromatograms. If <code>x</code> is a <code><a href='MChromatograms-class.html'>MChromatograms()</a></code> object, each
<code>Chromatogram</code> in it is aligned against <code>y</code>. Additional parameters (<code>...</code>)
are passed along to the alignment functions (e.g. <code>closest()</code>).</p>
<p>Parameter <code>method</code> allows to specify which alignment method
should be used. Currently there are the following options:</p><ul>
<li><p><code>method = "closest"</code> (the default): match data points in the first
chromatogram (<code>x</code>) to those of the second (<code>y</code>) based on the difference
between their retention times: each data point in <code>x</code> is assigned to the
data point in <code>y</code> with the smallest difference in their retention times
if their difference is smaller than the minimum average difference
between retention times in <code>x</code> or <code>y</code> (parameter <code>tolerance</code> for the
call to the <code>closest()</code> function).
By setting <code>tolerance = 0</code> only exact retention times are matched against
each other (i.e. only values are kept with exactly the same retention
times between both chromatograms).</p></li>
<li><p><code>method = "approx"</code>: uses the base R <code>approx</code> function to approximate
intensities in <code>x</code> to the retention times in <code>y</code> (using linear
interpolation). This should only be used for chromatograms that were
measured in the same measurement run (e.g. MS1 and corresponding MS2
chromatograms from SWATH experiments).</p></li>
</ul></li>
<li><p><code>bin</code>: aggregates intensity values from a chromatogram in discrete bins
along the retention time axis and returns a <code>Chromatogram</code> object with
the retention time representing the mid-point of the bins and the
intensity the binned signal. Parameters <code>binSize</code> and <code>breaks</code> allow to
define the binning, <code>fun</code> the function which should be used to aggregate
the intensities within a bin.</p></li>
<li><p><code>compareChromatograms</code>: calculates a similarity score between 2
chromatograms after aligning them. Parameter <code>ALIGNFUN</code> allows to define
a function that can be used to align <code>x</code> against <code>y</code> (defaults to
<code>ALIGNFUN = alignRt</code>). Subsequently, the similarity is calculated on the
aligned intensities with the function provided with parameter <code>FUN</code> which
defaults to <code>cor</code> (hence by default the Pearson correlation is calculated
between the aligned intensities of the two compared chromatograms).
Additional parameters can be passed to the <code>ALIGNFUN</code> and <code>FUN</code> with the
parameter <code>ALIGNFUNARGS</code> and <code>FUNARGS</code>, respectively.</p></li>
<li><p><code>clean</code>: removes 0-intensity data points (and <code>NA</code> values). See <code><a href='clean-methods.html'>clean()</a></code>
for details.</p></li>
<li><p><code>normalize</code>, <code>normalise</code>: <em>normalises</em> the intensities of a chromatogram by
dividing them either by the maximum intensity (<code>method = "max"</code>) or total
intensity (<code>method = "sum"</code>) of the chromatogram.</p></li>
</ul>

    <h2 class="hasAnchor" id="data-visualization"><a class="anchor" href="#data-visualization"></a>Data visualization</h2>

    

<ul>
<li><p><code>plot</code>: plots a <code>Chromatogram</code> object.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='MChromatograms-class.html'>MChromatograms</a> for combining <code>Chromatogram</code> in
a two-dimensional matrix (rows being mz-rt ranges, columns samples).
<code>chromatogram()] for the method to extract chromatogram data from an </code>MSnExp<code>or</code>OnDiskMSnExp<code>object. [clean()] for the method to *clean* a</code>Chromatogram` object.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'></span>
<span class='r-in'><span class='co'>## Create a simple Chromatogram object.</span></span>
<span class='r-in'><span class='va'>ints</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span>, sd <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>rts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>ints</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>chr</span> <span class='op'>&lt;-</span> <span class='fu'>Chromatogram</span><span class='op'>(</span>rtime <span class='op'>=</span> <span class='va'>rts</span>, intensity <span class='op'>=</span> <span class='va'>ints</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>chr</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Object of class: Chromatogram</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> length of object: 100</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> from file: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> mz range: [NA, NA]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> rt range: [1, 100]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> MS level: 1</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Extract intensities</span></span>
<span class='r-in'><span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   [1] 140.0043517  25.5317055 243.7263611   0.5571287  62.1552721 114.8411606</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   [7] 182.1817661  24.7325302  24.4199607  28.2705449  55.3699384  62.8982042</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [13] 206.5024895 163.0989402  51.2426950 186.3011492  52.2012515   5.2601910</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [19]  54.2996343  91.4074827  46.8154420  36.2951256 130.4543545  73.7776321</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [25] 188.8504929   9.7445104  93.5847354   1.5950311  82.6788954 151.2399651</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [31]  93.5363190  17.6488611  24.3685465 162.3548883  11.2038083  13.3997013</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [37] 191.0087468  27.9237242  31.3445978 106.7307879   7.0034850  63.9123324</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [43]   4.9964899  25.1483443  44.4797116 275.5417575   4.6531380  57.7709069</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [49]  11.8194874 191.1720491  86.2086482  24.3236740  20.6087195   1.9177592</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [55]   2.9560754  54.9827542 227.4114857 268.2557184  36.1221255  21.3355750</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [61] 107.4345882  66.5088249 111.3952419  24.5896412 117.7563309  97.5850616</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [67] 106.5057320  13.1670635  48.8628809 169.9450568 147.0736306  28.4150344</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [73] 133.7320413  23.6696283 131.8293384  52.3909788  60.6748047  10.9935672</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [79]  17.2181715   9.0327287 192.4343341 129.8392759  74.8791268  55.6224329</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [85]  54.8257264 111.0534893 261.2334333  15.5693776  43.3889790  38.1951112</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [91]  42.4187575 106.3101996 104.8712620   3.8102895  48.6148920 167.2882611</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [97]  35.4361164  94.6347886 131.6826356  29.6640025</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Extract retention times</span></span>
<span class='r-in'><span class='fu'><a href='Spectrum-class.html'>rtime</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [91]  91  92  93  94  95  96  97  98  99 100</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Extract the mz range - is NA for the present example</span></span>
<span class='r-in'><span class='fu'><a href='Spectrum-class.html'>mz</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] NA NA</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## plot the Chromatogram</span></span>
<span class='r-in'><span class='fu'><a href='plot-methods.html'>plot</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span></span>
<span class='r-plt'><img src='Chromatogram-class-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Create a simple Chromatogram object based on random values.</span></span>
<span class='r-in'><span class='va'>chr</span> <span class='op'>&lt;-</span> <span class='fu'>Chromatogram</span><span class='op'>(</span>intensity <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>1000</span>, mean <span class='op'>=</span> <span class='fl'>2000</span>, sd <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span class='r-in'>        rtime <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>1000</span>, mean <span class='op'>=</span> <span class='fl'>10</span>, sd <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>chr</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Object of class: Chromatogram</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> length of object: 1000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> from file: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> mz range: [NA, NA]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> rt range: [0.002530252, 23.75382]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> MS level: 1</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Get the intensities</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 1658.884 1828.917 1971.020 1935.111 1965.487 1752.787</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Get the retention time</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='Spectrum-class.html'>rtime</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0.002530252 0.004804333 0.086750187 0.102224373 0.114592272 0.155135059</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## What is the retention time range of the object?</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='Spectrum-class.html'>rtime</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1]  0.002530252 23.753823765</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Filter the chromatogram to keep only values between 4 and 10 seconds</span></span>
<span class='r-in'><span class='va'>chr2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='MSnExp-class.html'>filterRt</a></span><span class='op'>(</span><span class='va'>chr</span>, rt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='Spectrum-class.html'>rtime</a></span><span class='op'>(</span><span class='va'>chr2</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 4.031794 9.975626</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Data manipulations:</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## normalize a chromatogram</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='plot-methods.html'>plot</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='plot-methods.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='normalise-methods.html'>normalize</a></span><span class='op'>(</span><span class='va'>chr</span>, method <span class='op'>=</span> <span class='st'>"max"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-plt'><img src='Chromatogram-class-2.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Align chromatograms against each other</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>chr1</span> <span class='op'>&lt;-</span> <span class='fu'>Chromatogram</span><span class='op'>(</span>rtime <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>7</span>, <span class='fl'>8</span>, <span class='fl'>9</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>    intensity <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>14</span>, <span class='fl'>30</span>, <span class='fl'>24</span>, <span class='fl'>6</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>chr2</span> <span class='op'>&lt;-</span> <span class='fu'>Chromatogram</span><span class='op'>(</span>rtime <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2.5</span>, <span class='fl'>3.42</span>, <span class='fl'>4.5</span>, <span class='fl'>5.43</span>, <span class='fl'>6.5</span><span class='op'>)</span>,</span>
<span class='r-in'>    intensity <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>12</span>, <span class='fl'>15</span>, <span class='fl'>11</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='plot-methods.html'>plot</a></span><span class='op'>(</span><span class='va'>chr1</span>, col <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='fu'><a href='Spectrum-class.html'>rtime</a></span><span class='op'>(</span><span class='va'>chr2</span><span class='op'>)</span>, <span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>chr2</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"blue"</span>, type <span class='op'>=</span> <span class='st'>"l"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Align chr2 to chr1 without interpolation</span></span>
<span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>alignRt</span><span class='op'>(</span><span class='va'>chr2</span>, <span class='va'>chr1</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='Spectrum-class.html'>rtime</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1]  1  2  3  4  5  6  7  8  9 10</span>
<span class='r-in'><span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1] NA  5 12 15 11  5 NA NA NA NA</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='fu'><a href='Spectrum-class.html'>rtime</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>, <span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"#00ff0080"</span>, type <span class='op'>=</span> <span class='st'>"l"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Align chr2 to chr1 with interpolation</span></span>
<span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>alignRt</span><span class='op'>(</span><span class='va'>chr2</span>, <span class='va'>chr1</span>, method <span class='op'>=</span> <span class='st'>"approx"</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='fu'><a href='Spectrum-class.html'>rtime</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>, <span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"#ff000080"</span>, type <span class='op'>=</span> <span class='st'>"l"</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topright"</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"black"</span>, <span class='st'>"blue"</span>, <span class='st'>"#00ff0080"</span>,<span class='st'>"#ff000080"</span><span class='op'>)</span>,lty <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span class='r-in'>    legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"chr1"</span>, <span class='st'>"chr2"</span>, <span class='st'>"chr2 matchRtime"</span>, <span class='st'>"chr2 approx"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Compare Chromatograms. Align chromatograms with `alignRt` and</span></span>
<span class='r-in'><span class='co'>## method `"approx"`</span></span>
<span class='r-in'><span class='fu'>compareChromatograms</span><span class='op'>(</span><span class='va'>chr2</span>, <span class='va'>chr1</span>, ALIGNFUNARGS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"approx"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0.9768469</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Data filtering</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>chr1</span> <span class='op'>&lt;-</span> <span class='fu'>Chromatogram</span><span class='op'>(</span>rtime <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>7</span>, <span class='fl'>8</span>, <span class='fl'>9</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>    intensity <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>14</span>, <span class='fl'>30</span>, <span class='fl'>24</span>, <span class='fl'>6</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Remove data points with intensities below 10</span></span>
<span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>filterIntensity</span><span class='op'>(</span><span class='va'>chr1</span>, <span class='fl'>10</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 14 30 24</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Remove data points with an intensity lower than 10% of the maximum</span></span>
<span class='r-in'><span class='co'>## intensity in the Chromatogram</span></span>
<span class='r-in'><span class='va'>filt_fun</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>prop</span> <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>    <span class='va'>x</span><span class='op'>@</span><span class='va'>intensity</span> <span class='op'>&gt;=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>@</span><span class='va'>intensity</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>prop</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>filterIntensity</span><span class='op'>(</span><span class='va'>chr1</span>, <span class='va'>filt_fun</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1]  3  5 14 30 24  6</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Remove data points with an intensity lower than half of the maximum</span></span>
<span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>filterIntensity</span><span class='op'>(</span><span class='va'>chr1</span>, <span class='va'>filt_fun</span>, prop <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 30 24</span>
<span class='r-plt'><img src='Chromatogram-class-3.png' alt='' width='700' height='433' /></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


